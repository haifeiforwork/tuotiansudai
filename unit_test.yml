test-db-server:
  image: "ywatase/test-docker-mysql"
  ports:
    - "$UT_DB_PORT:3306"
  volumes:
    - ./scripts/ut.sql:/opt/ut.sql
  command: bash -c "/etc/init.d/mysql restart && mysql < /opt/ut.sql && /etc/init.d/mysql stop && /usr/bin/mysqld_safe"

test-redis-server:
  image: "grokzen/redis-cluster"
  ports:
    - "$UT_REDIS_PORT:7006"

test-sign-in:
  image: "leoshi/ttsd-signin-flask"
  environment:
    - "TZ=Asia/Shanghai"
  volumes:
    - ./signin_service:/app
  links:
    - "test-db-server"
    - "test-redis-server"
  command: ["python", "test.py"]