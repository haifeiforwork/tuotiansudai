require(["jquery","layerWrapper","jquery.validate","jquery.ajax.extension"],function(a,b){a(function(){function c(){a(".count-num").each(function(b,c){a(this).text(parseInt(a(this).attr("data-num"))*parseInt(e.val()))})}var d=a(".order-number"),e=d.find(".num-text"),f=d.find(".total-num i"),g=a("#orderBtn"),h=a("#addPlace"),i=a("#addressForm");d.on("click",".low-btn",function(a){a.preventDefault(),f.text()>0&&(e.val()>1?e.val(function(a,b){return parseInt(b)-1})&&c():e.val("1"))}).on("click",".add-btn",function(a){a.preventDefault(),f.text()>0&&(e.val()<parseInt(f.text())?e.val(function(a,b){return parseInt(b)+1})&&c():e.val(f.text()))}),c(),g.on("click",function(c){c.preventDefault();var d=a(this),f=d.attr("data-id"),g=d.attr("data-type");a.ajax({url:"/pointsystem/order",type:"POST",dataType:"json",data:{id:f,itemType:g,number:e.val()}}).done(function(a){console.log(a),a.data.status?location.href="/pointsystem/bill":b.msg(a.data.message)}).fail(function(a){b.msg("请求失败，请重试！")})}),h.on("click",function(c){c.preventDefault(),b.open({type:1,title:"添加地址",area:["700px","auto"],content:a("#fixAdress")})}),jQuery.validator.addMethod("isPhone",function(a,b){var c=/0?(13|14|15|18)[0-9]{9}/;return this.optional(b)||c.test(a)},"请正确填写您的手机号码"),i.validate({debug:!0,focusInvalid:!1,rules:{Recipient:{required:!0},Phone:{required:!0,isPhone:!0,minlength:11,maxlength:11},AddRess:{required:!0,maxlength:100}},messages:{Recipient:{required:"请填写收件人"},Phone:{required:"请输入手机号",isPhone:"请输入正确的手机号码",minlength:"手机格式不正确",maxlength:"手机格式不正确"},AddRess:{required:"请填写收件地址",maxlength:"收件地址字数在100字以内"}},errorPlacement:function(a,b){a.appendTo(b.parent())},submitHandler:function(c){a.ajax({url:"/path/to/file",type:"POST",dataType:"json",data:{Recipient:a("#Recipient").val(),Phone:a("#Phone").val(),AddRess:a("#AddRess").val()}}).done(function(a){location.reload()}).fail(function(){b.msg("请求失败，请重试！")})}})})});