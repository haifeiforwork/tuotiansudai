require(["jquery","layerWrapper","jquery.ajax.extension"],function(a,b){a(function(){var c=a("#pointDetail"),d=a("#exchangeTip"),e=a(".count-list",c),f=e.find(".num-text"),g=parseInt(f.val()),h=a("#getBtn"),i=parseInt(e.data("mylimit")),j=parseInt(e.data("buycount")),k=i-j;d.find("i").text(k),0==k&&h.addClass("disabled"),e.on("click",function(a){var b=a.target,c=parseInt(e.data("overplus"));g=parseInt(f.val());var d=0==k?c:Math.min(c,k);c<1||(/low-btn/.test(b.className)&&g>1?f.val(--g):/add-btn/.test(b.className)&&g<d&&f.val(++g))}),h.on("click",function(c){c.preventDefault();var d=a(this),e=d.attr("data-id"),g=d.attr("data-type");d.hasClass("disabled")||a.ajax({url:"/point-shop/hasEnoughGoods",type:"POST",dataType:"json",data:{id:e,goodsType:g,amount:f.val()}}).done(function(a){a.data.status?location.href="/point-shop/order/"+e+"/"+g+"/"+f.val():b.msg(a.data.message)}).fail(function(a){b.msg("请求失败，请重试！")})})})});