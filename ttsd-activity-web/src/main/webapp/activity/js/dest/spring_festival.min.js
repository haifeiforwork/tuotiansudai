require(["jquery","layerWrapper","commonFun","jquery.ajax.extension","logintip"],function(a,b,c){a(function(){function d(c){a.ajax({url:"/activity/point-draw/task-draw",type:"POST",dataType:"json",data:{activityCategory:"SPRING_FESTIVAL_ACTIVITY"}}).done(function(d){a("#numText").text(d.prizeValue),c.addClass("active").text("已签到"),b.open({type:1,move:!1,area:a(window).width()>700?["400px","300px"]:["280px","300px"],title:!1,content:a("#moneyTip")})}).fail(function(){b.msg("请求失败，请重试！")})}var e=globalFun.parseURL(location.href);a.when(c.isUserLogin()).done(function(){a(".check-in",a(".spring-festival-container")).show()}).fail(function(){a("#loginCheck").show()}),a("#checkIn").on("click",function(c){c.preventDefault();var e=a(this);a.ajax({url:"/point/sign-in",type:"POST",dataType:"json"}).done(function(a){a.data.status&&d(e)}).fail(function(){b.msg("请求失败,请重试!")})}),a("#loginCheck").on("click",function(b){b.preventDefault(),"app"==e.params.source?location.href="/login":a(".no-login-text",a(".spring-festival-container")).trigger("click")})})});