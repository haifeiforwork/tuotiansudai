require(["jquery","layerWrapper","commonFun","jquery.ajax.extension","logintip"],function(a,b,c){a(function(){function d(c){a.ajax({url:"/activity/point-draw/task-draw",type:"POST",dataType:"json",data:{activityCategory:"SPRING_FESTIVAL_ACTIVITY"}}).done(function(d){1==d.returnCode?b.msg("今日已签到，请明天再来！"):0==d.returnCode&&(a("#numText").text(d.prizeValue),c.addClass("active").text("已签到"),b.open({type:1,move:!1,area:a(window).width()>700?["400px","300px"]:["280px","300px"],title:!1,content:a("#moneyTip")}))}).fail(function(){b.msg("请求失败，请重试！")})}var e=globalFun.parseURL(location.href);a.when(c.isUserLogin()).done(function(){a(".check-in",a(".spring-festival-container")).show()}).fail(function(){"app"==e.params.source?(a("#loginCheck").show(),a(".check-in",a(".spring-festival-container")).hide()):(a(".check-in",a(".spring-festival-container")).show(),a("#loginCheck").hide())}),a("#checkIn").on("click",function(c){c.preventDefault();var e=a(this);a.ajax({url:"/point/sign-in",type:"POST",dataType:"json"}).done(function(a){""!=a.data.message&&null!=a.data.message?b.msg(a.data.message):d(e)}).fail(function(){b.msg("请求失败,请重试!")})}),a("#loginCheck").on("click",function(b){b.preventDefault(),"app"==e.params.source?location.href="/login":a(".no-login-text",a(".spring-festival-container")).trigger("click")}),a("#drawBtn").on("click",function(b){b.preventDefault(),d(a(this))})})});