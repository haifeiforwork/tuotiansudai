require(["jquery","drawCircle","commonFun","logintip","register_common"],function(a,b,c){a(function(){var d=globalFun.browserRedirect(),e=a("#newYearDayFrame"),f=a("#newYearSlide"),g=a("#loginIn"),h=location.href,i=globalFun.parseURL(h);!function(){g.on("click",function(){"app"==i.params.source?location.href="/login":a(".no-login-text",e).trigger("click")}),a(".to-referrer",e).on("click",function(){"app"==i.params.source?location.href="/app/tuotian/refer-reward":location.href="/referrer/refer-list"})}(),function(){var b,c=a(".slide-text",e),d=c.find("li").eq(0).height();c.hover(function(){clearInterval(b)},function(){b=setInterval(function(){var a=c.find(".slide-text-list");a.animate({"margin-top":-d+"px"},2e3,function(){a.css({"margin-top":"0px"}).find("li:first").appendTo(a)})},500)}).trigger("mouseout")}(),function(){if("pc"==d){var a='<div class="body-decorate" id="bodyDecorate"> <div class="bg-left"></div> <div class="bg-right"></div> </div>';e.prepend(a),f.addClass("pc-img")}else{f.html("<img src="+staticServer+"/activity/images/new-year/app-top.jpg>");var b=globalFun.parseURL(location.href);"yes"==b.params.tag&&e.find(".reg-tag-current").show()}}(),function(b){var d=a(".reward-gift-box",e),f=a("#rewardTaskStatus"),h=a(".reward-list-frame",e),j=a("#MobileNumber"),k="/activity/point-draw/all-list",l="/activity/point-draw/user-list",m="/activity/point-draw/task-draw",n=a(".gold-egg",d),o=j.length?j.data("mobile"):"",p=a("#signToday"),q=d.find(".my-times").data("times"),r={info:"",button:"",area:[]},s={mobile:o,activityCategory:"ANNUAL_ACTIVITY"};h.find(".reward-box").each(function(b,c){var d=f.val().split(",");1==d[b]&&a(c).addClass("finished")}),a.when(c.isUserLogin()).done(function(){a(".signedIn-status .normal-button",d).show()}).fail(function(){console.log("未登陆"),g.show()}),b.prototype.signToday=function(b,c){p.on("click",function(d){"signToday"==d.target.id&&a.ajax({url:"/point/sign-in",type:"POST",dataType:"json"}).done(function(a){b&&b(a)}).fail(function(){c&&c()})})};var b=new b(k,l,m,s,d);b.signToday(function(){var c="";"true"==a("#inActivityDate").val()&&(c='<p class="des-text">恭喜您获得砸金蛋机会一次</p>'),r.button='<a href="javascript:void(0)" class="go-on go-close">知道了</a>',r.info='<p class="success-text">签到成功！</p>'+c,p.text("已签到");var e=Number(d.find(".my-times").text());"true"==a("#inActivityDate").val()&&d.find(".my-times").text(e+1),p.removeAttr("id"),b.tipWindowPop(r)},function(){r.button="",r.info='<p class="login-text">请与客服联系</p>',b.tipWindowPop(r)}),b.GiftRecord(),b.MyGift(),n.on("click",function(){a.when(c.isUserLogin()).done(function(){}).fail(function(){"app"==i.params.source?location.href="/login":a(".no-login-text",e).trigger("click")}),n.hasClass("win-result")||(n.addClass("win-result"),setTimeout(function(){b.beginLuckDraw(function(a){n.removeClass("win-result"),0==a.returnCode?("CONCRETE"==a.prizeType?(r.button='<a href="javascript:void(0)" class="go-on go-close">继续抽奖</a>',r.info='<p class="success-text">恭喜您！</p><p class="reward-text">抽中了'+a.prizeValue+'！</p><p class="des-text">拓天客服将会在7个工作日内联系您发放奖品</p>'):"VIRTUAL"==a.prizeType&&(r.button='<a href="/my-treasure" class="double-btn">去查看</a><a href="javascript:void(0)" class="go-on go-close">继续抽奖</a>',r.info='<p class="success-text">恭喜您！</p><p class="reward-text">'+a.prizeValue+'！</p><p class="des-text">奖品已发放至“我的宝藏”当中。</p>'),b.noRotateFn(r),d.find(".my-times").text(--q)):1==a.returnCode?(r.info='<p class="login-text">您暂无抽奖机会啦～</p><p class="des-text">赢取机会后再来抽奖吧！</p>',r.button='<a href="javascript:void(0)" class="go-close">知道了</a>',b.tipWindowPop(r)):2==a.returnCode||(3==a.returnCode?(r.info='<p class="login-text">不在活动时间内~</p>',b.tipWindowPop(r)):4==a.returnCode&&(r.info='<p class="login-text">您还未实名认证~</p><p class="des-text">请实名认证后再来抽奖吧！</p>',r.button='<a href="javascript:void(0)" class="go-close">知道了</a>',b.tipWindowPop(r)))})},1500))}),b.PrizeSwitch()}(b)})});