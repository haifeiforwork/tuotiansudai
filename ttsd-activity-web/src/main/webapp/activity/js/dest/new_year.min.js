require(["jquery","drawCircle","commonFun","logintip","register_common"],function(a,b,c){a(function(){var d=globalFun.browserRedirect(),e=a("#newYearDayFrame"),f=a("#newYearSlide"),g=a("#loginIn"),h=location.href,i=globalFun.parseURL(h),j={};e.find(".tip-list").each(function(b,c){var d=a(c).data("return");j[d]=c}),function(){g.on("click",function(){"app"==i.params.source?location.href="/login":a(".no-login-text",e).trigger("click")}),a(".to-referrer",e).on("click",function(){"app"==i.params.source?location.href="/app/tuotian/refer-reward":location.href="/referrer/refer-list"})}(),function(){var b,c=a(".slide-text",e),d=c.find("li").eq(0).height();c.hover(function(){clearInterval(b)},function(){b=setInterval(function(){var a=c.find(".slide-text-list");a.animate({"margin-top":-d+"px"},2e3,function(){a.css({"margin-top":"0px"}).find("li:first").appendTo(a)})},500)}).trigger("mouseout")}(),function(){if("pc"==d){var a='<div class="body-decorate" id="bodyDecorate"> <div class="bg-left"></div> <div class="bg-right"></div> </div>';e.prepend(a),f.addClass("pc-img")}else{f.html("<img src="+staticServer+"/activity/images/new-year/app-top.jpg>");var b=globalFun.parseURL(location.href);"yes"==b.params.tag&&e.find(".reg-tag-current").show()}}(),function(b){var d=a(".reward-gift-box",e),f=a("#rewardTaskStatus"),h=a(".reward-list-frame",e),k=a("#MobileNumber"),l="/activity/point-draw/all-list",m="/activity/point-draw/user-list",n="/activity/point-draw/task-draw",o=a(".gold-egg",d),p=k.length?k.data("mobile"):"",q=a("#signToday"),r={mobile:p,activityCategory:"ANNUAL_ACTIVITY"};h.find(".reward-box").each(function(b,c){var d=f.val().split(",");1==d[b]&&a(c).addClass("finished")}),a.when(c.isUserLogin()).done(function(){a(".signedIn-status .normal-button",d).show()}).fail(function(){console.log("未登陆"),g.show()}),b.prototype.signToday=function(b,c){q.on("click",function(d){"signToday"==d.target.id&&(a(this).prop("disabled",!0),a.ajax({url:"/point/sign-in",type:"POST",dataType:"json"}).done(function(a){b&&b(a)}).fail(function(){c&&c()}))})};var b=new b(l,m,n,r,d);b.signToday(function(){b.tipWindowPop(j.signOk,function(){q.text("已签到");var b=Number(d.find(".my-times").text());"true"==a("#inActivityDate").val()&&d.find(".my-times").text(b+1),q.removeAttr("id")})},function(){b.tipWindowPop(j.signNo)}),b.GiftRecord(),b.MyGift(),o.on("click",function(){o.hasClass("win-result")||(o.addClass("win-result"),setTimeout(function(){b.beginLuckDraw(function(c){if(o.removeClass("win-result"),0==c.returnCode){var f;f="app"==i.params.source?"app/tuotian/myfortune-unuse":"/my-treasure";var g=c.prizeType.toLowerCase();a(j[g]).find(".prizeValue").text(c.prizeValue),a(j[g]).find(".my-treasure").attr("href",f);var h=parseInt(d.find(".my-times").text());d.find(".my-times").text(function(){return h>0?h-1:0}),b.noRotateFn(j[g])}else 1==c.returnCode?(d.find(".my-times").text("0"),b.tipWindowPop(j.nochance)):2==c.returnCode?"app"==i.params.source?location.href="/login":a(".no-login-text",e).trigger("click"):3==c.returnCode?b.tipWindowPop(j.expired):4==c.returnCode&&b.tipWindowPop(j.authentication)})},1500))}),b.PrizeSwitch()}(b)})});