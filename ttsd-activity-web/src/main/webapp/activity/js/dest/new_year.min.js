require(["jquery","drawCircle","commonFun","logintip","register_common"],function(a,b,c){a(function(){var d=globalFun.browserRedirect(),e=a("#newYearDayFrame"),f=a("#newYearSlide"),g=a("#loginIn");!function(){var b=location.href,c=globalFun.parseURL(b);"app"==c.params.source?location.href="/login":g.on("click",function(){a(".no-login-text",e).trigger("click")})}(),function(){var b,c=a(".slide-text",e),d=c.find("li").eq(0).height();c.hover(function(){clearInterval(b)},function(){b=setInterval(function(){var a=c.find(".slide-text-list");a.animate({"margin-top":-d+"px"},2e3,function(){a.css({"margin-top":"0px"}).find("li:first").appendTo(a)})},500)}).trigger("mouseout")}(),function(){if("pc"==d){var a='<div class="body-decorate" id="bodyDecorate"> <div class="bg-left"></div> <div class="bg-right"></div> </div>';e.prepend(a),f.addClass("pc-img")}else{f.html("<img src="+staticServer+"/activity/images/new-year/app-top.jpg>");var b=globalFun.parseURL(location.href);"yes"==b.params.tag&&e.find(".reg-tag-current").show()}}(),function(b){var d=a(".reward-gift-box",e),f=a("#rewardTaskStatus"),h=a(".reward-list-frame",e),i=a("#MobileNumber"),j="/activity/point-draw/all-list",k="/activity/point-draw/user-list",l="/activity/point-draw/task-draw",m=a(".gold-egg",d),n=i.length?i.data("mobile"):"",o=a("#signToday"),p=d.find(".my-times").data("times"),q={info:"",button:"",area:[]},r={mobile:n,activityCategory:"ANNUAL_ACTIVITY"};h.find(".reward-box").each(function(b,c){var d=f.val().split(",");1==d[b]&&a(c).addClass("finished")}),a.when(c.isUserLogin()).done(function(){a(".signedIn-status .normal-button",d).show()}).fail(function(){console.log("未登陆"),g.show()}),b.prototype.signToday=function(b,c){o.on("click",function(d){"signToday"==d.target.id&&a.ajax({url:"/point/sign-in",type:"POST",dataType:"json"}).done(function(a){b&&b(a)}).fail(function(){c&&c()})})};var b=new b(j,k,l,r,d);b.signToday(function(){q.button='<a href="javascript:void(0)" class="go-on go-close">知道了</a>',q.info='<p class="success-text">签到成功！</p><p class="des-text">恭喜您获得砸金蛋机会一次</p>',o.text("已签到");var a=Number(d.find(".my-times").text());d.find(".my-times").text(a+1),o.removeAttr("id"),b.tipWindowPop(q)},function(){q.button="",q.info='<p class="login-text">请与客服联系</p>',b.tipWindowPop(q)}),b.GiftRecord(),b.MyGift(),m.on("click",function(){m.hasClass("win-result")||(m.addClass("win-result"),setTimeout(function(){b.beginLuckDraw(function(c){m.removeClass("win-result"),0==c.returnCode?("CONCRETE"==c.prizeType?(q.button='<a href="javascript:void(0)" class="go-on go-close">继续抽奖</a>',q.info='<p class="success-text">恭喜您！</p><p class="reward-text">抽中了'+c.prizeValue+'！</p><p class="des-text">拓天客服将会在7个工作日内联系您发放奖品</p>'):"VIRTUAL"==c.prizeType&&(q.button='<a href="/my-treasure" class="double-btn">去查看</a><a href="javascript:void(0)" class="go-on go-close">继续抽奖</a>',q.info='<p class="success-text">恭喜您！</p><p class="reward-text">'+c.prizeValue+'！</p><p class="des-text">奖品已发放至“我的宝藏”当中。</p>'),b.noRotateFn(q),d.find(".my-times").text(--p)):1==c.returnCode?(q.info='<p class="login-text">您暂无抽奖机会啦～</p><p class="des-text">赢取机会后再来抽奖吧！</p>',q.button='<a href="javascript:void(0)" class="go-close">知道了</a>',b.tipWindowPop(q)):2==c.returnCode?a(".no-login-text",e).trigger("click"):3==c.returnCode?(q.info='<p class="login-text">不在活动时间内~</p>',b.tipWindowPop(q)):4==c.returnCode&&(q.info='<p class="login-text">您还未实名认证~</p><p class="des-text">请实名认证后再来抽奖吧！</p>',q.button='<a href="javascript:void(0)" class="go-close">知道了</a>',b.tipWindowPop(q))})},1500))}),b.PrizeSwitch()}(b)})});