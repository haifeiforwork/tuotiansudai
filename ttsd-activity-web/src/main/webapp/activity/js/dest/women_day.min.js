require(["jquery","layerWrapper","template","jquery.ajax.extension","register_common","logintip"],function(a,b,c){a(function(){var d=globalFun.browserRedirect(),e=a("#womenDayContainer"),f=a(".machine-lottery",e),g=a(".sign-btn span",f);if("mobile"==d){var h=globalFun.parseURL(location.href);"yes"==h.params.tag&&a(".reg-tag-current").show()}var i={layerShow:function(){b.open({type:1,closeBtn:0,move:!1,area:a(window).width()>700?["420px","234px"]:["300px","190px"],title:!1,content:a("#tipItem")})},getLottery:function(){a.ajax({url:"/point/sign-in",type:"POST",dataType:"json"}).done(function(d){a.ajax({url:"/activity/point-draw/task-draw",type:"POST",dataType:"json",data:{activityCategory:"WOMAN_DAY_ACTIVITY"}}).done(function(d){g.removeClass("sign-active").addClass("sign-already"),2==d.returnCode?a(".no-login-text",e).trigger("click"):0==d.returnCode?(b.open({type:1,closeBtn:0,move:!1,area:a(window).width()>700?["420px","40px"]:["300px","40px"],title:!1,content:a("#loadingItem")}),setTimeout(function(){b.closeAll(),a("#tipItem").html(c("tipItemTpl",d)),i.layerShow(),i.giftRecord(),i.myGift()},1500)):(a("#tipItem").html(c("tipItemTpl",d)),i.layerShow())}).fail(function(){b.msg("请求失败，请重试！")})}).fail(function(){b.msg("请求失败,请重试!")})},giftRecord:function(){a.ajax({url:"/activity/point-draw/all-list",type:"GET",dataType:"json",data:{activityCategory:"WOMAN_DAY_ACTIVITY"}}).done(function(b){a("#recordList").html(c("recordListTpl",{recordlist:b}))}).fail(function(){b.msg("请求失败，请重试！")})},myGift:function(){a.ajax({url:"/activity/point-draw/user-list",type:"GET",dataType:"json",data:{activityCategory:"WOMAN_DAY_ACTIVITY"}}).done(function(b){a("#myRecord").html(c("myRecordTpl",{myrecord:b}))}).fail(function(){b.msg("请求失败，请重试！")})},scrollList:function(a,b){var c=a,d=c.find("li:first").height();c.find("li").length>(""!=b?b:10)&&c.animate({"margin-top":-d+"px"},600,function(){c.css({"margin-top":"0px"}).find("li:first").appendTo(c)})},hoverScrollList:function(a,b){var c,d=this;a.hover(function(){clearInterval(c)},function(){c=setInterval(function(){d.scrollList(a,b)},2e3)}).trigger("mouseout")}};g.on("click",function(a){a.preventDefault(),g.hasClass("sign-already")||(g.addClass("sign-active"),i.getLottery())});var j=f.find(".menu-switch").find("span");j.on("click",function(){var b=a(this),c=b.index(),d=f.find(".record-list ul");b.addClass("active").siblings().removeClass("active"),d.eq(c).show().siblings().hide()}),i.giftRecord(),i.myGift(),i.hoverScrollList(a("#lotteryList").find(".user-record"),7)})});