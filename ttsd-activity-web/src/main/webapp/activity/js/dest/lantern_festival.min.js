require(["jquery","drawCircle","template","layerWrapper","logintip"],function(a,b,c,d){function e(a,b){var c=new Date(a);c.setDate(c.getDate()+b);var d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate();return d+"-"+(e<10?"0"+e:e)+"-"+(f<10?"0"+f:f)}function f(b){a.ajax({url:"/activity/hero-ranking/invest/"+b,type:"GET",dataType:"json"}).done(function(b){if(b.status){a("#investRanking-tbody").parents("table");a("#investRanking-tbody").html(c("tplTable",b))}}).fail(function(){d.msg("请求失败，请重试！")})}var g=a("#lanternFrame"),h={},i=a("#TodayAwards"),j=a("#investRanking-button"),k=a("#heroNext"),l=(a("#referPre"),a.trim(i.val()));g.find(".tip-list-frame .tip-list").each(function(b,c){var d=a(c).data("return");h[d]=c}),l.replace(/-/gi,"")>=20170220&&(k.hide(),$referNext.hide()),j.find("span").on("click",function(b){var c,d=a("#HistoryAwards"),g=d.val();/heroPre/.test(b.target.id)?c=e(g,-1):/heroNext/.test(b.target.id)&&(c=e(g,1)),c.replace(/-/gi,"")>=20170220?k.hide():k.show(),c.replace(/-/gi,"")<=20170206?$heroPre.hide():$heroPre.show(),d.val(c),f(c)}),f(i.val()),function(b){var c=a(".reward-gift-box",g),d=a("#MobileNumber"),e="/activity/lantern-festival/all-prize-list",f="/activity/lantern-festival/user-prize-list",i="/activity/lantern-festival/prize",j="/activity/lantern-festival/drawTime",k=a(".pointer-img",c),l=d.length?d.data("mobile"):"",m={mobile:l,activityCategory:"LANTERN_FESTIVAL_ACTIVITY"};b.prototype.showDrawTime=function(){a.ajax({url:j,type:"GET",dataType:"json"}).done(function(b){a(".draw-time",c).text(b)})};var b=new b(e,f,i,m,c,3);b.GiftRecord(3),b.MyGift(3),b.showDrawTime(),k.on("click",function(){k.hasClass("win-result")||(k.addClass("win-result"),setTimeout(function(){b.beginLuckDraw(function(c){if(k.removeClass("win-result"),b.showDrawTime(),0==c.returnCode){var d=c.prizeType.toLowerCase();a(h[d]).find(".prizeValue").text(c.prizeValue),b.noRotateFn(h[d])}else 1==c.returnCode?b.tipWindowPop(h.nochance):2==c.returnCode?a(".no-login-text",g).trigger("click"):3==c.returnCode?b.tipWindowPop(h.expired):4==c.returnCode&&b.tipWindowPop(h.authentication)})},1e3))});var n=c.find(".menu-switch span");n.on("click",function(){var b=a(this),d=b.index(),e=c.find(".record-list ul");b.addClass("active").siblings().removeClass("active"),e.eq(d).show().siblings("ul").hide()})}(b),a(window).width()<700&&a(".bg-two .wp",g).append(a(".bg-two .rule-model",g))});