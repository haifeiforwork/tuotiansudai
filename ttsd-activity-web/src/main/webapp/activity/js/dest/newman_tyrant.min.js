require(["jquery","layerWrapper","template","logintip","jquery.ajax.extension"],function(a,b,c){a(function(){function d(d,e){a.ajax({url:"/activity/newman-tyrant/"+d+"/"+e,type:"GET",dataType:"json"}).done(function(b){b={status:!0,message:null,index:0,pageSize:0,count:0,maxPage:0,hasPreviousPage:!1,hasNextPage:!1,records:[{loginName:"130****9958",sumAmount:182e5,userName:"刘丽娜",mobile:"13051419958",centSumAmount:"182000.00"},{loginName:"139****1689",sumAmount:14606e3,userName:"姚勉",mobile:"13942031689",centSumAmount:"146060.00"},{loginName:"185****1897",sumAmount:115e5,userName:"管淑清",mobile:"18510171897",centSumAmount:"115000.00"},{loginName:"134****3549",sumAmount:5e6,userName:"高立斌",mobile:"13426473549",centSumAmount:"50000.00"},{loginName:"188****0295",sumAmount:2002800,userName:"尤洪君",mobile:"18831480295",centSumAmount:"20028.00"},{loginName:"186****8659",sumAmount:2e6,userName:"张聪",mobile:"18643918659",centSumAmount:"20000.00"},{loginName:"139****5001",sumAmount:2e6,userName:"刘惠杰",mobile:"13932705001",centSumAmount:"20000.00"},{loginName:"132****6796",sumAmount:1582700,userName:"杜云英",mobile:"13283226796",centSumAmount:"15827.00"},{loginName:"186****9482",sumAmount:14e5,userName:"苗瑞",mobile:"18600809482",centSumAmount:"14000.00"},{loginName:"139****7336",sumAmount:7e5,userName:"周真真",mobile:"13916017336",centSumAmount:"7000.00"}]},b.status&&a("#rankTable").html(c("rankTableTpl",b))}).fail(function(){b.msg("请求失败，请重试！")})}function e(a,b){var c=new Date(a);c.setDate(c.getDate()+b);var d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate();return d+"-"+(e<10?"0"+e:e)+"-"+(f<10?"0"+f:f)}var f=a("#newmanTyrant"),g=a(".board-tab span",f),h=a("#infoDate"),i=a.trim(h.attr("data-date")).replace(/-/gi,""),j=a.trim(h.attr("data-startTime")).replace(/-/gi,""),k=a.trim(h.attr("data-endTime")).replace(/-/gi,""),l=a(".board-btn span",f),m=a("#heroNext"),n=a("#heroPre"),o=a("#getHistory");i==j?(n.hide(),m.hide()):i==k?m.hide():i>j&&i<k?(n.show(),m.hide()):i>k?(n.show(),m.hide()):(n.hide(),m.hide()),g.on("click",function(b){b.preventDefault();var c=a(this),e=c.attr("data-type"),f=a.trim(h.text());c.addClass("active").siblings().removeClass("active"),d(e,f)}),l.on("click",function(b){var c,f=a.trim(h.text());/heroPre/.test(b.target.id)?c=e(f,-1):/heroNext/.test(b.target.id)&&(c=e(f,1)),c.replace(/-/gi,"")==j?(n.hide(),m.show()):c.replace(/-/gi,"")==i&&c.replace(/-/gi,"")>j?(n.show(),m.hide()):c.replace(/-/gi,"")==k&&c.replace(/-/gi,"")==i?(n.show(),m.hide()):c.replace(/-/gi,"")>j&&c.replace(/-/gi,"")<i&&(n.show(),m.show()),h.text(c),d(a(".board-tab span.active").attr("data-type"),a.trim(h.text()))}),a("body").on("click",".close-tip",function(a){a.preventDefault(),b.closeAll()}),d("tyrant",a.trim(h.text())),o.on("click",function(d){d.preventDefault(),i<j?b.msg("活动暂未开始！"):i>k?b.msg("活动已结束！"):a.ajax({url:"/activity/newman-tyrant/history",type:"GET",dataType:"json"}).done(function(d){console.log(d.records),a("#historyContent").html(c("historyContentTpl",d)),b.open({type:1,closeBtn:0,move:!1,area:a(window).width()>700?["600px","auto"]:["300px","auto"],title:!1,content:a("#tipContainer")})}).fail(function(){b.msg("请求失败，请重试！")})})})});