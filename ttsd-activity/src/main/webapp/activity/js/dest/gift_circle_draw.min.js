define(["jquery","rotate","layerWrapper","template"],function(a,b,c,d){function e(b,d,e,f){this.bRotate=!1,this.allListURL=b,this.userListURL=d,this.drawURL=e,this.mobileNumber=f,this.beginLotteryDraw=function(b){this.bRotate||a.ajax({url:this.drawURL+"?mobile="+this.mobileNumber,type:"POST",dataType:"json"}).done(function(a){b(a)}).fail(function(){c.msg("请求失败")})},this.GiftRecord=function(){a.ajax({url:this.allListURL,type:"GET",dataType:"json"}).done(function(a){})},this.MyGift=function(){a.ajax({url:this.userListURL+"?mobile="+f,type:"GET",dataType:"json"}).done(function(a){})}}var f=(a(".gift-record li"),a(".gift-circle-frame"));return e.prototype.rotateFn=function(b,c,e){this.bRotate=!this.bRotate,a(".rotate-btn",f).stopRotate(),a(".rotate-btn",f).rotate({angle:0,animateTo:b+1800,duration:8e3,callback:function(){a(".tip-list",f).html(d("tipListTpl",{tiptext:"抽中了"+c,istype:e})).show().find(".tip-dom").show(),this.bRotate=!this.bRotate,this.GiftRecord(),this.MyGift(),a(".lottery-time",f).each(function(b,c){a(this).text()>1?a(this).text(function(a,b){return parseInt(b)-1}):a(this).text("0")})}})},e.prototype.scrollList=function(a){var b=a,c=b.find("li:first").height();b.find("li").length>10&&b.animate({"margin-top":-c+"px"},600,function(){b.css({"margin-top":"0px"}).find("li:first").appendTo(b)})},e.prototype.PrizeSwitch=function(b,c){b.on("click",function(b){var d=a(this),b=d.index();c.eq(b).show().siblings().hide()})},a("body").on("click",".go-close",function(b){b.preventDefault();var c=a(this),d=c.parents(".tip-list"),e=d.find(".tip-dom");c.hasClass("go-on")&&window.location.reload(),d.hide(),e.hide()}),e});