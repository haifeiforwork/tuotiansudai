require(["jquery","underscore","layerWrapper","template","logintip","jquery.ajax.extension","commonFun","register_common"],function(a,b,c,d){a(function(){function d(a,b){var c=new Date(a);c.setDate(c.getDate()+b);var d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate();return d+"-"+(e<10?"0"+e:e)+"-"+(f<10?"0"+f:f)}function e(d){a.ajax({url:"/activity/hero-ranking/invest/"+d+"?activityCategory=NEW_HERO_RANKING",type:"GET",dataType:"json"}).done(function(c){if(c.status){var d=a(".table-list-item"),e=a("#investRanking-tbody").parents("table");if(b.isNull(c.records)||0==c.records.length)return d.find(".table-content").html('<span class="date-over">暂无数据</span>'),e.hide(),void a("#bgItem").hide();e.show(),a("#bgItem").show(),c.type="invest",a("#investRanking-tbody").html(l(c)),a("#bgItem").html(n(c))}}).fail(function(){c.msg("请求失败，请重试！")})}var f=commonFun.browserRedirect(),g=a("#TodayAwards"),h=a("#investRanking-button"),i=a("#heroNext"),j=(a("#heroPre"),a.trim(g.val())),k=a("#tplTable").html(),l=b.template(k),m=a("#bgtplTable").html(),n=b.template(m);if("mobile"==f){var o=commonFun.parseURL(location.href);"yes"==o.params.tag&&a(".reg-tag-current").show()}j.replace(/-/gi,"")>=a("#startTime").val()&&i.hide(),h.find(".change-btn").on("click",function(a){var b,c=g.val();/heroPre/.test(a.target.id)?(b=d(c,-1),i.show()):/heroNext/.test(a.target.id)&&(b=d(c,1),b.replace(/-/gi,"")>=j.replace(/-/gi,"")?i.hide():i.show()),e(b)}),e(j)})});