define(["jquery","rotate","layerWrapper","template","jquery.validate","jquery.validate.extension","jquery.ajax.extension"],function(a,b,c,d){function e(b,c,d){bRotateTd=!bRotateTd,a("#rotateTd").stopRotate(),a("#rotateTd").rotate({angle:0,animateTo:c+1800,duration:8e3,callback:function(){switch(a("#tipList").show(),j(),b){case 0:a("#twentyRMB").show();break;case 1:a("#iphone6s").show();break;case 2:a("#jdCard").show();break;case 3:a("#jiaxi").show();break;case 4:a("#macbookAir").show()}bRotateTd=!bRotateTd}})}function f(a){var b=a.find("ul.user-record"),c=b.find("li:first").height();b.find("li").length>15&&b.animate({"margin-top":-c+"px"},600,function(){b.css({"margin-top":"0px"}).find("li:first").appendTo(b)})}function g(){a.ajax({url:"/activity/getTianDouTop15",type:"POST",dataType:"json"}).done(function(b){var c={rank:b};a("#rankList").html(d("rankListTpl",c))})}function h(){a.ajax({url:"/activity/getTianDouPrizeList",type:"POST",dataType:"json"}).done(function(b){a("#GiftRecord").html(d("GiftRecordTpl",b))})}function i(){a.ajax({url:"/activity/getMyTianDouPrize",type:"POST",dataType:"json"}).done(function(b){var c={tdmygift:b};a("#MyGift").html(d("MyGiftTpl",c))})}function j(){g(),h(),i()}var k=!1,l=a("#pointer"),m=(a("#rotate"),a(".gift-record li"));m.on("click",function(b){var c=a(this),d=c.index();c.addClass("active").siblings("li").removeClass("active"),a("#recordList").find(".record-model:eq("+d+")").addClass("active").siblings(".record-model").removeClass("active")}),l.on("click",function(b){b.preventDefault();var d=a(this),f=d.attr("data-islogin");if("true"!=f)a("#tipList").show(),a("#noLogin").show();else{if(k)return;a.ajax({url:"/activity/draw-tiandou",type:"POST",dataType:"json"}).done(function(b){if(0==b.data.returnCode){var c=b.data.tianDouPrize;switch(c){case"Cash20":e(0,56,"20元现金");break;case"Iphone6s":e(1,120,"iPhone 6s Plus");break;case"JingDong300":e(2,200,"300元京东购物卡");break;case"InterestCoupon5":e(3,260,"0.5%加息券");break;case"MacBook":e(4,337,"MacBook Air")}}else 1==b.data.returnCode?(a("#tipList").show(),a("#TDnoUse").show()):(a("#tipList").show(),a("#noLogin").show())}).fail(function(){c.msg("请求失败")})}}),a("body").on("click",".go-close",function(b){b.preventDefault();var c=a(this),d=c.parents(".tip-list"),e=d.find(".tip-dom");d.hide(),e.hide()});var n;a(".scroll-record").hover(function(){clearInterval(n)},function(){n=setInterval(function(){f(a(".scroll-record"))},2e3)}).trigger("mouseout")});