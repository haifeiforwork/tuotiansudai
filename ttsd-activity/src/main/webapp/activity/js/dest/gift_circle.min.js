define(["jquery","rotate","layerWrapper","template","jquery.validate","jquery.validate.extension","jquery.ajax.extension"],function(a,b,c,d){function e(b,c,e){g=!g,a("#rotate").stopRotate(),a("#rotate").rotate({angle:0,animateTo:c+1800,duration:8e3,callback:function(){a("#tipList").html(d("tipListTpl",{tiptext:"恭喜你抽中了"+e})).show().find(".tip-dom").show(),g=!g}})}function f(a){var b=a.find("ul.user-record"),c=b.find("li:first").height();b.find("li").length>10&&b.animate({"margin-top":-c+"px"},600,function(){b.css({"margin-top":"0px"}).find("li:first").appendTo(b)})}var g=!1,h=a("#pointer"),i=(a("#rotate"),a(".gift-record li"));i.on("click",function(b){var c=a(this),d=c.index();c.addClass("active").siblings("li").removeClass("active"),a("#recordList").find(".record-model:eq("+d+")").addClass("active").siblings(".record-model").removeClass("active")}),h.on("click",function(b){b.preventDefault(),g||a.ajax({url:"/activity/draw-lottery",type:"POST",dataType:"json"}).done(function(b){if(console.log(b),0==b.returnCode){var c=b.lotteryPrize;switch(c){case"INTEREST_COUPON_2":e(0,56,"0.2加息券");break;case"LUXURY":e(0,56,"奢侈品大奖");break;case"RED_ENVELOPE_100":e(1,120,"100元现金红包");break;case"INTEREST_COUPON_5":e(2,200,"0.5加息券");break;case"RED_ENVELOPE_50":e(3,260,"50元现金红包");break;case"PORCELAIN_CUP":e(4,337,"青花瓷杯子")}}else 2==b.returnCode?a("#tipList").html(d("tipListTpl",{tiptext:b.message})).show().find(".tip-dom").show():a("#tipList").html(d("tipListTpl",{tiptext:b.message})).show().find(".tip-dom").show()}).fail(function(){c.msg("请求失败")})}),a("body").on("click",".go-close",function(b){b.preventDefault();var c=a(this),d=c.parents(".tip-list"),e=d.find(".tip-dom");d.hide(),e.hide()});var j;a(".user-record").hover(function(){clearInterval(j)},function(){j=setInterval(function(){f(a("#recordList"))},2e3)}).trigger("mouseout");(function(){a.ajax({url:"/activity/lottery-record-list",type:"POST",dataType:"json"}).done(function(b){a("#GiftRecord").html(d("GiftRecordTpl",{record:b}))})})(),function(){a.ajax({url:"/activity/lottery-record-list",type:"POST",dataType:"json"}).done(function(b){a("#MyGift").html(d("MyGiftTpl",{gift:b}))})}()});