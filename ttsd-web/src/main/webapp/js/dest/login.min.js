require(["jquery"],function(a){a(function(){var b=a(".error"),c=function(){var b=a(".login .img-captcha img");b.attr("src","/login/captcha?"+(new Date).toTimeString())};a(".login .img-captcha img").click(c),a(".login-name").blur(function(){var c="用户名不能为空",e=a(this);""==e.val().trim()?(e.removeClass("lock").addClass("unlock"),b.addClass("wrong").text(c)):(e.removeClass("unlock").addClass("lock"),b.removeClass("wrong").text("")),d()}),a(".password").blur(function(){var c="密码不能为空",e=a(this);""==e.val()?(e.removeClass("lock").addClass("unlock"),b.addClass("wrong").text(c)):(e.addClass("lock").removeClass("unlock"),b.removeClass("wrong").text("")),d()}),a(".captcha").blur(function(){var e=a(this),f="验证码错误",g=e.val();g.length<5?(e.removeClass("lock").addClass("unlock"),b.addClass("wrong").text(f),d()):a.ajax({url:"/login/captcha/"+g+"/verify",type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(b){b.data.status?(e.addClass("lock").removeClass("unlock"),a(".error").removeClass("wrong").text("")):(a(".error").addClass("wrong").text(f),e.removeClass("lock").addClass("unlock"),c()),d()})});var d=function(){for(var b=a(".form-login"),c=0;3>c;c++){if(b.find("label").eq(c).find("input").hasClass("unlock"))return a(".login-now").addClass("grey").attr("disabled","disabled"),!1;a(".login-now").removeClass("grey").removeAttr("disabled")}};a(".login-now").click(function(){var b=a(this);if(!b.hasClass("grey")){var d=a(".form-login").serialize();a.ajax({url:"/loginHandler",type:"post",data:d,beforeSend:function(){b.addClass("loading")}}).done(function(d){d.data.status?(window.location.href="/",console.log("success")):(c(),a(".captcha").addClass("unlock").removeClass("lock").val(""),a(".error").addClass("wrong").text("用户名或密码错误")),b.removeClass("loading")})}})})});