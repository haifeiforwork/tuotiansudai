require(["jquery","csrf"],function(a){a(function(){var b=/^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/;a(".phone-txt").keyup(function(){if(11==a(this).val().length&&b.test(a(this).val())){a(this).val()}else a(this).addClass("error").removeClass("valid-ok")}),a(".fetch-captcha").on("click",function(){a(".layer-box").show(),c()}),a(".close").on("click",function(){a(".verification-code,.verification-code-main").hide()}),a(".mobile").blur(function(){var b=a(this);""==b.val()||b.hasClass("error")?a(".fetch-captcha").addClass("grey").attr("disabled","disabled"):a(".fetch-captcha").removeClass("grey").removeAttr("disabled")}),a(".complete").click(function(){function b(){a(".fetch-captcha").html(e+"秒后重新发送").css({background:"#666","pointer-events":"none"}),0==e&&(clearInterval(f),a(".fetch-captcha").html("重新发送").css({background:"#f68e3a","pointer-events":"auto"})),e--}var c=a(".mobile").val(),d=a(".verification-code-text").val(),e=30,f=setInterval(b,1e3);a(".layer-box").hide(),a.get("/register/mobile/"+c+"/image-captcha/"+d+"/send-register-captcha")});var c=function(){var b=a(".verification-code-img");b.attr("src","/register/image-captcha?"+(new Date).toTimeString())};a(".verification-code-img").click(function(){c()}),a(".verification-code-text").blur(function(){var b=a(this),d=b.val();d.length<5?a(".verification-code-main b").css("display","inline-block"):a.ajax({url:"/register/image-captcha/"+d+"/verify",type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(b){b.data.status?(a(".verification-code-main b").hide(),a(".complete").removeClass("grey").removeAttr("disabled")):(a(".verification-code-main b").css("display","inline-block"),a(".complete").addClass("grey").attr("disabled"),c())})})})});