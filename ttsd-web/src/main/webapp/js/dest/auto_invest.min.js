require(["jquery","commonFun","layer","underscore","jquery.ajax.extension","autoNumeric","jquery.validate"],function(a,b,c,d){a(function(){if(a("#btnAuthority").length){var e=a("#btnAuthority");e.click(function(){var b='<div cass="auto-invest"><button id="finishAuthor" class="btn btn-normal">已完成授权</button></div>';c.open({type:1,title:"自动投标授权",area:["400px","140px"],content:b}),a("#finishAuthor").on("click",function(){location.href="/auto-invest/plan"})})}if(a("#planSwitchDom").length){var f=a("#planSwitchDom"),g=a(".switchBtn",f),h=a("label.radio",g),i=a(".projectLimit",f),j=a('input[type="radio"]',f),k=a("#saveInvestPlan"),l=a("#signPlanForm");b.initRadio(j,h),a("#plan-close").is(":checked")&&f.find("dl").first().show().siblings().hide(),a("input.autoNumeric").autoNumeric("init"),i.each(function(){var b=a(this),c=parseInt(b.data("value"));isNaN(c)||b.find("span").each(function(){var b=a(this),d=parseInt(b.data("value"));(d&c)==d&&b.addClass("active")})}),h.click(function(b){var c=a(this),d=c.prev("input").val();1==d?f.find("dl").show().siblings().show():a.ajax({url:"/auto-invest/turn-off",type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(a){f.find("dl").first().show().siblings().hide()}).fail(function(a){console.log(a)})});var m=function(){var b,c=[];return i.find("span.active").each(function(){var b=a(this);c.push(b.data("value"))}),b=d.sum(c)},n=function(){var b=m(),c=a("input.autoNumeric",l).serializeArray(),e=d.map(c,"value");b>0&&!d.isEmpty(e[0])&&!d.isEmpty(e[1])&&!d.isEmpty(e[2])?k.prop("disabled",!1).addClass("btn-normal"):k.prop("disabled",!0).removeClass("btn-normal")};i.find("span").click(function(){var b=a(this);b.toggleClass("active"),n()}),a("#checkOption").click(function(){n()}),a("input",l).bind("keyup",function(){n()}),n(),k.click(function(){var b={minInvestAmount:a('input[name="minInvestAmount"]').autoNumeric("get"),maxInvestAmount:a('input[name="maxInvestAmount"]').autoNumeric("get"),retentionAmount:a('input[name="retentionAmount"]').autoNumeric("get"),autoInvestPeriods:m()};return parseInt(b.maxInvestAmount)<parseInt(b.minInvestAmount)?(alert("投资金额范围输入有误"),!1):void a.ajax({url:"/auto-invest/turn-on",data:JSON.stringify(b),type:"POST",dataType:"json",contentType:"application/json; charset=UTF-8"}).done(function(a){a.data.status&&(location.href="plan-detail")}).fail(function(a){console.log(a)})})}a("#editSetting").length&&a("#editSetting").click(function(){var a=location.href.replace(/plan-detail/,"plan");location.href=a})})});