require(["jquery","mustache","text!../../tpl/investrecordtable.tpl","moment","daterangepicker"],function(a,b,c,d){function e(d){var e=a("#daterangepicker").val().split("~"),f=a.trim(e[0]),h=a.trim(e[1]),i=a(".query-type").find(".current").attr("data-value"),j="";if(i&&(j="&loanStatus="+i),""==f||"undefined"==f)var k=API_AJAX+"?pageIndex="+d+j;else var k=API_AJAX+"?beginTime="+f+"&endTime="+h+"&pageIndex="+d+j;a.get(k,function(d){var e=b.render(c,d);a("#tpl").html(e),g=d.index})}function f(){var b=a(".start-end span.current").attr("day");b&&(1==b?a("#daterangepicker").val(i+"~"+i):7==b?a("#daterangepicker").val(j+"~"+i):30==b?a("#daterangepicker").val(k+"~"+i):a("#daterangepicker").val(l+"~"+i),e(1))}var g,h=d(),i=h.format("YYYY-MM-DD"),j=h.subtract(6,"days").format("YYYY-MM-DD"),k=h.subtract(30,"days").format("YYYY-MM-DD"),l=h.subtract(180,"days").format("YYYY-MM-DD");console.log("今天："+i),a("#daterangepicker").dateRangePicker({separator:" ~ "}).val(i+"~"+i),e(1),a(".start-end .jq-n").click(function(){a(this).addClass("current").siblings(".jq-n").removeClass("current"),f()}),a(".query-type .jq-n").click(function(){a(this).addClass("current").siblings(".jq-n").removeClass("current"),e(1)}),a(".apply-btn").click(function(){e(1)}),a(document).on("click",".pagination .nextPage",function(){g++,e(g)}),a(document).on("click",".pagination .prevPage",function(){g--,e(g)})});