require(["jquery","mustache","text!/tpl/point-bill-table.mustache","moment","pagination","daterangepicker"],function(a,b,c,d,e){a(function(){var e=a(".column-title .title-navli"),f=a("#signBtn"),g=a("#signLayer"),h=a("#closeSign"),i=a("#taskBtn"),j=a("#taskLayer"),k=a("#closeTask");e.on("click",function(b){b.preventDefault();var c=a(this),d=c.index();c.addClass("active").siblings().removeClass("active"),a(".content-list .choi-beans-list:eq("+d+")").show().siblings().hide()}),f.on("click",function(b){b.preventDefault(),g.fadeIn("fast",function(){a(this).find(".add-dou").animate({bottom:"50px",opacity:"0"},800)})}),h.on("click",function(b){b.preventDefault(),g.fadeOut("fast",function(){a(this).find(".add-dou").css({bottom:"0",opacity:"1"})})}),i.on("click",function(a){a.preventDefault(),j.fadeIn("fast")}),k.on("click",function(a){a.preventDefault(),j.fadeOut("fast")});var l=d().format("YYYY-MM-DD"),m=d().subtract(1,"week").format("YYYY-MM-DD"),n=d().subtract(1,"month").format("YYYY-MM-DD"),o=d().subtract(6,"month").format("YYYY-MM-DD"),p=a(".date-filter"),q=a(".status-filter"),r=a("#date-picker"),s=a(".pagination");r.dateRangePicker({separator:" ~ "});var t=function(){var b=a(".date-filter .select-item.current").data("day");switch(b){case 1:r.val(l+"~"+l);break;case 7:r.val(m+"~"+l);break;case 30:r.val(n+"~"+l);break;case 180:r.val(o+"~"+l);break;default:r.val("")}},u=function(d){var e=r.val().split("~"),f=a.trim(e[0])||"",g=a.trim(e[1])||"",h=a(".status-filter .select-item.current").data("status"),i={startTime:f,endTime:g,businessType:h,index:d||1};s.loadPagination(i,function(d){d.status&&_.each(d.records,function(a){switch(a.businessType){case"SIGN_IN":a.businessType="签到奖励";break;case"TASK":a.businessType="任务奖励";break;case"INVEST":a.businessType="任务奖励";break;case"EXCHANGE":a.businessType="财豆兑换"}});var e=b.render(c,d);a(".point-bill-list").html(e)})};t(),u(),p.find(".select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),t(),u()}),q.find(".select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),u()}),a(".apply-btn").on("click",function(b){b.preventDefault(),u(),a(".date-filter .select-item").removeClass("current")})})});