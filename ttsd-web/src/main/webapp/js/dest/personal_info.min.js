require(["jquery","layer","jquery.validate","jquery.validate.extension","jquery.form"],function(a,b){a(function(){var c=a("#personInfoBox"),d=a(".setEmail",c),e=a(".setPass",c),f=(a("#btnChangeEmail"),a("#changeEmailDOM")),g=a("form",f),h=(a("#btnChangePass"),a("#changePassDOM")),i=a("form",h);d.on("click",function(){b.open({type:1,title:"绑定邮箱",area:["500px","230px"],shadeClose:!0,content:f})}),g.validate({rules:{email:{required:!0,email:!0}},messages:{email:"请输入有效的邮箱地址"},submitHandler:function(){b.closeAll(),b.open({type:1,title:"验证邮箱",area:["500px","220px"],shadeClose:!0,content:a("#CESuccess"),btn:["返回"],yes:function(a,c){b.close(a)}})}}),e.on("click",function(){b.open({type:1,title:"修改密码",area:["500px","300px"],shadeClose:!0,content:h,cancel:function(){i.validate().resetForm()}})}),i.validate({focusCleanup:!0,focusInvalid:!1,errorClass:"fa fa-times-circle error",validClass:"fa fa-check-circle valid",onkeyup:function(b,c){var d=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===c.which&&""===this.elementValue(b)||-1!==a.inArray(c.keyCode,d)||this.element(b)},onfocusout:function(a){this.checkable(a)||this.optional(a)||this.element(a)},submitHandler:function(b){var c=this;return a(b).ajaxSubmit({dataType:"json",beforeSubmit:function(a,b,d){c.resetForm()},success:function(a){var b=a.data;b.status},error:function(){},complete:function(){}}),!1},rules:{originalPassword:{required:!0,rangelength:[6,20],regex:"^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$",isNotExist:"/personal-info/password/{0}/is-exist"},newPassword:{required:!0,rangelength:[6,20],regex:"^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$"},newPasswordConfirm:{required:!0,rangelength:[6,20],regex:"^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$",equalTo:"input[name='newPassword']"}},messages:{originalPassword:{required:"请输入原密码",regex:"原密码不正确",rangelength:"原密码不正确",isNotExist:"原密码不正确"},newPassword:{required:"请输入新密码",regex:"只能字母和数字组合",rangelength:"长度6至20位"},newPasswordConfirm:{required:"请输入新密码",regex:"只能字母和数字组合",rangelength:"长度6至20位",equalTo:"密码不一致"}}})})});