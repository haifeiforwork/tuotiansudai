require(["jquery","mustache","text!/tpl/investor-invest-table.mustache","text!/tpl/investor-invest-repay-table.mustache","moment","pagination","daterangepicker"],function(a,b,c,d,e,f){var g=e().format("YYYY-MM-DD"),h=e().subtract(1,"week").format("YYYY-MM-DD"),i=e().subtract(1,"month").format("YYYY-MM-DD"),j=e().subtract(6,"month").format("YYYY-MM-DD"),k=a("#date-picker"),l=a(".pagination"),m=a(".layer-container");k.dateRangePicker({separator:" ~ "}).val(g+"~"+g);var n=function(){var b=a(".date-filter .select-item.current").data("day");switch(b){case 1:k.val(g+"~"+g);break;case 7:k.val(h+"~"+g);break;case 30:k.val(i+"~"+g);break;case 180:k.val(j+"~"+g);break;default:k.val("")}};a(".layer-mask").click(function(){return m.hide(),!1});var o=function(e){var f=k.val().split("~"),g=a.trim(f[0])||"",h=a.trim(f[1])||"",i=a(".status-filter .select-item.current").data("status"),j={startTime:g,endTime:h,status:i,index:e||1};l.loadPagination(j,function(e){var f=b.render(c,e);a(".invest-list-content .invest-list").html(f),a(".invest-list .show-invest-repay").click(function(){a.ajax({url:a(this).data("url"),type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).success(function(c){var e=c.data;if(e.isLoanCompleted="COMPLETE"==i,e.csrfToken=a("meta[name='_csrf']").attr("content"),e.status){_.each(e.records,function(a){switch(e.loanId=a.loanId,a.loanRepayStatus){case"REPAYING":a.status="待还";break;case"COMPLETE":a.status="完成";break;case"CANCEL":a.status="流标";break;case"CONFIRMING":a.status="确认中"}});var f=b.render(d,e);a(".layer-content").remove(),m.append(f).show(),a(".layer-container .close").click(function(){return m.hide(),!1})}})})})};o(1),a(".date-filter .select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),n(),o()}),a(".status-filter .select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),o()}),a(".apply-btn").click(function(){o()}),a(".layer-box .close").click(function(){return a(".layer-box").hide(),!1}),a(".layer-fix").click(function(){a(".layer-box").hide()})});