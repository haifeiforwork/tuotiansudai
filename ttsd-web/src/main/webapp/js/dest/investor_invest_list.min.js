require(["jquery","template","mustache","text!/tpl/investor-invest-repay-table.mustache","text!/tpl/investor-invest-experience-repay-table.mustache","moment","pagination","layerWrapper","daterangepicker","jquery.ajax.extension"],function(a,b,c,d,e,f,g,h){var i=f().format("YYYY-MM-DD"),j=f().subtract(1,"week").format("YYYY-MM-DD"),k=f().subtract(1,"month").format("YYYY-MM-DD"),l=f().subtract(6,"month").format("YYYY-MM-DD"),m=a(".date-filter"),n=a(".status-filter"),o=a("#date-picker"),p=a(".pagination");o.dateRangePicker({separator:" ~ "});var q=function(){var b=a(".date-filter .select-item.current").data("day");switch(b){case 1:o.val(i+"~"+i);break;case 7:o.val(j+"~"+i);break;case 30:o.val(k+"~"+i);break;case 180:o.val(l+"~"+i);break;default:o.val("")}},r=function(c){var d=o.val().split("~"),e=a.trim(d[0])||"",f=a.trim(d[1])||"",g=a(".status-filter .select-item.current").data("status"),h={startTime:e,endTime:f,status:g,index:c||1};p.loadPagination(h,function(c){a("#investList").html(b("investListTpl",c))})};a("body").on("click",".show-invest-repay",function(b){b.preventDefault(),a.ajax({url:a(this).data("url"),type:"get",dataType:"json",contentType:"application/json; charset=UTF-8"}).success(function(b){var f=b.data;if(f.isLoanCompleted="COMPLETE"==status,f.csrfToken=a("meta[name='_csrf']").attr("content"),f.status){_.each(f.records,function(a){var b=a.loan||"";f.loanId=b.id}),console.log(f);var g=1==f.loanId?c.render(e,f):c.render(d,f);h.open({type:1,title:"回款详情",skin:"repay-layer-pop",area:["1000px"],shadeClose:!0,content:g})}}),b.stopPropagation()}).on("mouseenter",".project-name",function(){h.closeAll("tips"),a.trim(a(this).text()).length>15&&h.tips(a(this).text(),a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".birth-icon",function(){h.closeAll("tips");var b=parseFloat(a(this).data("benefit")),c=b+1;h.tips("您已享受生日福利，首月收益翻"+c+"倍",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".coupon-icon",function(){h.closeAll("tips");var b=parseFloat(a(this).data("benefit")),c=b==b.toFixed(0)?b.toFixed(0):b.toFixed(1);h.tips("您使用了"+c+"%加息券",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".money-icon",function(){h.closeAll("tips");var b=a(this).data("benefit");h.tips("您使用了"+b+"元红包",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".newbie-icon",function(){h.closeAll("tips");var b=parseFloat(a(this).data("benefit")).toFixed(0);h.tips("您使用了"+b+"元体验金",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".ticket-icon",function(){h.closeAll("tips");var b=parseFloat(a(this).data("benefit")).toFixed(0);h.tips("您使用了"+b+"元体验金",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".first-icon",function(){h.closeAll("tips"),h.tips("我获得了0.2%加息券和50元红包",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".max-icon",function(){h.closeAll("tips"),h.tips("我获得了0.5%加息券和100元红包",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".last-icon",function(){h.closeAll("tips"),h.tips("我获得了0.2%加息券和50元红包",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".coupon",function(){var b=a(this).data("benefit");h.closeAll("tips"),h.tips(b,a(this),{tips:[1,"#ff7200"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".fee",function(){var b=a(this).data("benefit");h.closeAll("tips"),h.tips(b,a(this),{tips:[1,"#ff7200"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".repay",function(){var b=a(this).data("benefit");h.closeAll("tips"),h.tips(b,a(this),{tips:[1,"#ff7200"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}).on("mouseenter",".extra-rate",function(){var b=a(this).data("benefit");h.closeAll("tips"),h.tips("投资奖励"+b+"%",a(this),{tips:[1,"#efbf5c"],time:2e3,tipsMore:!0,area:"auto",maxWidth:"500"})}),q(),r(),m.find(".select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),q(),r()}),n.find(".select-item").click(function(){a(this).addClass("current").siblings(".select-item").removeClass("current"),r()}),a(".apply-btn").click(function(){r(),a(".date-filter .select-item").removeClass("current")})});